<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:fragment="head">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <th:block th:with="fontUrl='https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap'">
            <link rel="stylesheet" th:href="@{${fontUrl}}"/>
        </th:block>

        <link rel="stylesheet" th:href="@{https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css}">

        <link rel="stylesheet" th:href="@{/css/style.css}">
    </th:block>
</head>
<body>
<div th:fragment="menu">
    <div style="position: fixed; bottom: 0; width: 100%; background-color: #333; color: white; padding: 10px;">
        <nav>
            <ul style="display: flex; justify-content: center; align-items: center; margin: 0; padding: 0;">
                <li style="list-style: none; margin-right: 20px;"><a href="#">Hem</a></li>
                <li style="list-style: none; margin-right: 20px;"><a th:href="@{'/' + ${userEmail} + '/groups'}">Grupper</a></li>
                <li style="list-style: none; margin-right: 20px;"><a th:href="@{'/' + ${userEmail} + '/transactions'}">Budget</a></li>
                <li style="list-style: none; margin-right: 20px;"><a href="#">Inst√§llningar</a></li>
            </ul>
        </nav>
    </div>
</div>

<div th:fragment="scripts">
    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/popper.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/main.js}"></script>
</div>

<div th:fragment="piechart">
    <script th:src="@{/js/Chart.min.js}"></script>
    <script th:inline="javascript">
        var data = {
            labels: [],
            datasets: [{
                data: [],
                backgroundColor: []
            }]
        };

        function getRandomColor() {
            var letters = '0123456789ABCDEF';
            var color = '#';

            for (var i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }

            return color;
        }

        var dataMap = /*[[${dataMap}]]*/ {};

        Object.keys(dataMap).forEach(function(key) {
            data.labels.push(key);
            data.datasets[0].data.push(dataMap[key]);
            data.datasets[0].backgroundColor.push(getRandomColor());
        });

        var totalAmount = /*[[${totalAmount}]]*/ 0;
        var options = {
            responsive: true,
            title: {
                display: true,
                text: 'Transactions by Category (Total Amount: ' + totalAmount.toFixed(2) + ')'
            }
        };

        var ctx = document.getElementById('pie-chart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: data,
            options: options
        });

    </script>
</div>

</body>
</html>

